![image](https://github.com/user-attachments/assets/407ea9cc-8f8b-4703-a1ac-5fb4313e6e69)# Graph Neural Networks (GNNs) for Android Malware Detection

## Overview

This project explores the application of Graph Neural Networks (GNNs) to detect Android malware using the CIC-AndMal2017 dataset. GNNs are deep learning models that predict data structures represented as graphs, capturing relationships between entities (nodes) and their connections (edges). The project focuses on multiple GNN models and techniques, including Graph Convolutional Networks (GCNs), Graph Sample and Aggregated (GraphSAGE), and Graph Autoencoders (GAEs), to classify Android applications as benign or malicious.

## Models

### Graph Autoencoders (GAE)
GAEs learn meaningful representations of graph data for various tasks, such as node classification, link prediction, and graph clustering. They consist of an encoder that learns topological and node feature embeddings and a decoder that reconstructs the graph from these embeddings.

## Dataset

The dataset used in this project is the **CIC-AndMal2017** Android malware dataset, consisting of 2126 CSV files. Each file corresponds to network flows captured from Android applications at three stages:

- **Installation**: Immediately after the app is installed.
- **Before Reboot**: 15 minutes before the device is rebooted.
- **After Reboot**: 15 minutes after the device is rebooted.

The dataset contains 85 fields describing each flow, and the files are categorized into Adware, Ransomware, Scareware, SMS Malware, and Benign groups.

## Data Processing

The data is processed to construct **flow graphs** where:

- **Nodes**: Represent endpoints involved in any flow.
- **Edges**: Represent flows between endpoints.
- **Edge Features**: Aggregated using five statistical functions—mean, standard deviation, skewness, kurtosis, and median—resulting in a 295-dimensional feature vector per edge.

### Labels
- **0**: Benign graphs
- **1**: Malware graphs

## Model Implementation

### Network Flow Graph Autoencoder

An **Autoencoder** model is used for unsupervised anomaly detection, consisting of:

1. **Encoder**: Compresses edge features.
2. **Decoder**: Reconstructs the graph, where reconstruction error indicates anomaly score.

High anomaly scores suggest malicious activity.

### Evaluation Metrics

- **Precision-Recall Curve**
- **AUC-ROC Curve**

These metrics are used to evaluate the model's performance, with a higher AUC indicating better discrimination between benign and malware graphs.
![Description of Image](output.png)

![Description of Image](output2.png)

## References

- Data Source: [CIC-AndMal2017](https://www.unb.ca/cic/datasets/andmal2017.html)
- [Graph Neural Networks Introduction](https://viblo.asia/p/gioi-thieu-ve-graph-neural-networks-gnns-yZjJYG7MVOE)
- [Graph Convolutional Networks](https://mbernste.github.io/posts/gcn/)


